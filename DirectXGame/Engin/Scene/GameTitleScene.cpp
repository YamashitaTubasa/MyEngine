#include "GameTitleScene.h"

using namespace DirectX;

GameTitleScene::GameTitleScene()
{
}

GameTitleScene::~GameTitleScene()
{
	delete particleMan1;
}

void GameTitleScene::Initialize()
{
	particleMan1 = ParticleManager::Create();
	particleMan1->LoadTexture(L"Resources/effect1.png");
	particleMan1->Update();

	for (int i = 0; i < 100; i++) {
		// X,Y,Zすべて[-5.0f,+5.0f]でランダムに分布
		const float md_pos = 10.0f;
		XMFLOAT3 pos{};
		float px = 5;
		float py = 3;
		float pz = 3;
		pos.x = (float)rand() / RAND_MAX * px - px / 2.0f + px;
		pos.y = (float)rand() / RAND_MAX * py - py / 2.0f + py;
		pos.z = (float)rand() / RAND_MAX * pz - pz / 2.0f;
		// X,Y,Z全て[-0.05f,+0.05f]でランダム分布
		const float md_vel = 0.1f;
		XMFLOAT3 vel{};
		vel.x = (float)rand() / RAND_MAX * md_vel - md_vel / 2.0f;
		vel.y = (float)rand() / RAND_MAX * md_vel - md_vel / 2.0f;
		vel.z = (float)rand() / RAND_MAX * md_vel - md_vel / 2.0f;
		// 重力に見立ててYのみ[-0.001f,0]でランダム分布
		XMFLOAT3 acc{};
		const float md_acc = 0.001f;
		acc.y = (float)rand() / RAND_MAX * md_acc;

		// 追加
		particleMan1->Add(60, pos, vel, acc, 1.0f, 0.0);
	}
}

void GameTitleScene::Update()
{
	//// カメラ移動
	//if (input->PushKey(DIK_W) || input->PushKey(DIK_S) || input->PushKey(DIK_D) || input->PushKey(DIK_A))
	//{
	//	if (input->PushKey(DIK_W)) { ParticleManager::CameraMoveEyeVector({ 0.0f,+1.0f,0.0f }); }
	//	else if (input->PushKey(DIK_S)) { ParticleManager::CameraMoveEyeVector({ 0.0f,-1.0f,0.0f }); }
	//	if (input->PushKey(DIK_D)) { ParticleManager::CameraMoveEyeVector({ +1.0f,0.0f,0.0f }); }
	//	else if (input->PushKey(DIK_A)) { ParticleManager::CameraMoveEyeVector({ -1.0f,0.0f,0.0f }); }
	//}

	particleMan1->Update();
}

void GameTitleScene::Draw(DirectXCommon* dXCommon)
{
	// 3Dオブジェクト描画前処理
	ParticleManager::PreDraw(dXCommon->GetCommandList());

	// 3Dオブクジェクトの描画
	particleMan1->Draw();

	/// <summary>
	/// ここに3Dオブジェクトの描画処理を追加できる
	/// </summary>

	// 3Dオブジェクト描画後処理
	ParticleManager::PostDraw();
}
